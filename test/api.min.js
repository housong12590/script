/*! kxshop_wx-1.0.0.js 2018-05-17 */

function GetRequest(){var e=location.search,a=new Object;if(-1!=e.indexOf("?")){var t=e.substr(1);strs=t.split("&");for(var o=0;o<strs.length;o++)a[strs[o].split("=")[0]]=unescape(strs[o].split("=")[1])}return a}function getProductInfo(e){window.location.href="product_detail.html?product_id="+e}function getOauth(e,a){mui.get(api_wx_user_info,{code:e},function(e){200==e.status_code&&($.cookie("hwkx_open_id",e.data.open_id,{path:"/",domain:domain}),$.cookie("platform_user_id",e.data.platform_user_id,{path:"/",domain:domain}),open_id=$.cookie("hwkx_open_id"),window.location.href=a)})}function isFollow(e){mui.get(api_wx_focus,{open_id:e},function(e){if(200==e.status_code)return!0;err_event(e.status_code)})}function wxOuth(){var e=window.location.href;mui.get(api_wx_verify,{url:e},function(e){wxConfig(e.data.timestamp,e.data.noncestr,e.data.signature)})}function wxConfig(e,a,t){wx.config({debug:!1,appId:appId,timestamp:e,nonceStr:a,signature:t,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","chooseWXPay","getLocation","onMenuShareQQ","onMenuShareQZone"]}),wx.ready(function(){wx.checkJsApi({jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","chooseWXPay","getLocation","onMenuShareQQ","onMenuShareQZone"]}),wx.onMenuShareTimeline({title:share_title,link:share_link,imgUrl:share_img,success:function(){},cancel:function(){}}),wx.onMenuShareAppMessage({title:share_title,desc:share_desc,link:share_link,imgUrl:share_img,type:"",dataUrl:"",success:function(){},cancel:function(){}}),wx.onMenuShareQQ({title:share_title,desc:share_desc,link:share_link,imgUrl:share_img,success:function(){},cancel:function(){}}),wx.onMenuShareQZone({title:share_title,desc:share_desc,link:share_link,imgUrl:share_img,success:function(){},cancel:function(){}}),wx.getLocation({type:"wgs84",success:function(e){e.latitude,e.longitude,e.speed,e.accuracy}})}),wx.error(function(){})}function err_event(e,a){switch(e){case 301:no_user();break;case 302:no_goods_in_shopcart();break;case 303:no_goods_find_by_add();break;case 304:goods_collected();break;case 305:no_address_find();break;case 306:have_goods_down();break;case 307:no_goods_find_by_pay();break;case 308:no_illness_find();break;case 309:no_openid();break;case 310:no_order();break;case 311:no_collect();break;case 312:no_logistics();break;case 313:code_error();break;case 314:no_goods_find_by_pay_list();break;case 315:goods_invalid();break;case 316:toBind();break;case 317:binded();break;case 318:toFollow();break;case 319:no_address(a);break;case 300:signNoRight();break;case 3e4:bind_faile()}lastLoading()}function no_user(){}function no_goods_in_shopcart(){}function no_goods_find_by_add(){makeErrBoxHtml("商品已下架！","去首页","index.html")}function goods_collected(){location.reload()}function no_address_find(){location.reload()}function have_goods_down(){makeErrBoxHtml("订单已生产，请到我的订单完成支付。","Go我的订单","order.html")}function no_goods_find_by_pay(){makeErrBoxHtml("购物车中存在已下架商品！","确定","closeErrBox")}function no_illness_find(){location.reload()}function no_openid(){makeErrBoxHtml("open_id为空","确认","closeErrBox")}function no_order(){location.reload()}function no_collect(){location.reload()}function no_logistics(){makeErrBoxHtml("此订单暂无物流信息","确认","closeErrBox")}function code_error(){errShow("验证码不正确！")}function no_goods_find_by_pay_list(){makeErrBoxHtml("结算列表存在已下架商品！","返回购物车","shopping_cart.html")}function goods_invalid(){makeErrBoxHtml("结算列表存在失效商品！","刷新","closeErrBox")}function toBind(){var e=location.href;$.cookie("from_url",e,{path:"/",domain:domain}),window.location.href="bind_tag.html"}function binded(){makeErrBoxHtml("手机号已被绑定","确认","closeErrBox")}function toFollow(){window.location.href="https://mp.weixin.qq.com/mp/profile_ext?action=home&__biz=MzIyOTgzMjQyNQ==&scene=110#wechat_redirect"}function no_address(e){makeErrBoxHtml("您还没有可用的配送地址，请新建一个地址","确认",e)}function bind_faile(){makeErrBoxHtml("绑定失败！","确认","closeErrBox")}function makeErrBoxHtml(e,a,t){var o=[];o.push('<div class="mui-backdrop"></div>'),o.push('<div class="api-err-box">'),o.push('<div class="msg">'+e+"</div>"),o.push('<div class="btn-box">'),o.push('<a class="btn-pay" data-url="'+t+'" href="#">'+a+"</a>"),o.push("</div></div>"),$("body").append(o.join(""))}function closeErrBox(){$(".api-err-box").hide(),$(".mui-backdrop").hide(),location.reload()}function closeErrBox2(){$(".api-err-box").hide(),$(".mui-backdrop").hide()}function lastLoading(){mui(".api-err-box").on("tap",".btn-pay",function(){var e=$(this).data("url");"closeErrBox"==e?closeErrBox():window.location.href=e})}function guessUserLike(){var e=httpGet(api_guess_user_like,{});200==e.status_code?(likeList=e.data.products,tpl.render()):err_event(e.status_code)}function setSign(e){var a=CryptoJS.enc.Utf8.parse("8yt4poM8bEDU8CxW"),t=CryptoJS.enc.Utf8.parse("8yt4poM8bEDU8CxW"),o=arrToStr(e,"&");return CryptoJS.AES.encrypt(md5(o),a,{iv:t,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}).toString()}function arrToStr(e,a){var t=[],o=0;for(var s in e)t[o]=s+"="+e[s],o++;for(var n=t.sort(),i="",r=n.length,c=0;c<r;c++)i+=c==r-1?n[c]:n[c]+a;return i}function dataCount(){var e=pageName(),a=Date.parse(new Date)/1e3,t={open_id:open_id,timestamp:a,type:e[0]},o=setSign(t);t.signture=o}function pageName(){var e=location.href.split("/");return e.slice(e.length-1,e.length).toString(String).split(".").slice(0,1)}function httpPost(e,a){var t=Date.parse(new Date)/1e3;a.open_id=open_id,a.timestamp=t;var o=setSign(a);a.signature=o;var s="";return mui.ajax(e,{data:a,dataType:"json",type:"post",async:!1,header:{"Content-Type":"application/json"},success:function(e){s=e},error:function(e,a,t){}}),s}function httpPostNoEncrypt(e,a){var t="";return mui.ajax(e,{data:a,dataType:"json",type:"post",async:!1,header:{"Content-Type":"application/json"},success:function(e){t=e},error:function(e,a,t){}}),t}function httpGet(e,a){a.open_id=open_id,a.timestamp=Date.parse(new Date)/1e3;var t=setSign(a);a.signature=t;var o="";return mui.ajax(e,{data:a,dataType:"json",type:"get",async:!1,header:{"Content-Type":"application/json"},success:function(e){o=e},error:function(e,a,t){}}),o}function httpGetNoEncrypt(e,a){var t="";return mui.ajax(e,{data:a,dataType:"json",type:"get",async:!1,header:{"Content-Type":"application/json"},success:function(e){t=e},error:function(e,a,t){}}),t}var accesspath="https://m.jiankanghao.net/",base="https://www.jiankanghao.net/api/v1",api_banners=base+"/banners",api_hot_illnesses=base+"/illnesses",api_hot_search=base+"/illnesses/hot_search",api_illnesses=base+"/illnesses",api_search=base+"/search",api_brands_illness=base+"/tags/brands_illnesses",api_bookTags=base+"/tags/books",api_products=base+"/products",api_product_detail=base+"/products/detail",api_collects=base+"/collection/list",api_collect_add=base+"/collection/add",api_collect_delete=base+"/collection/delete",api_guess_user_like=base+"/products/recommended",api_is_on=base+"/products/on_off",api_addresses=base+"/addresses",api_address_add=base+"/addresses/add",api_address_update=base+"/addresses/update",api_address_delete=base+"/addresses/delete",api_address_info=base+"/addresses/detail",api_address_default=base+"/addresses/default",api_users_update=base+"/users/update_info",api_user_info=base+"/users/info",api_bind_phone=base+"/users/bind_phone",api_bind_sign=base+"/users/bind_sign",api_verify_code=base+"/users/verification_code",api_shopcart_list=base+"/shopcart/list",api_shopcart_add=base+"/shopcart",api_shopcart_delete=base+"/shopcart/delete",api_shopcart_update=base+"/shopcart/update_product",api_shopcart_price=base+"/shopcart/price",api_settlement=base+"/shopcart/settlement",api_shopcart_verify=base+"/shopcart/verify",api_shopcart_pay=base+"/shopcart/pay",api_buy_again=base+"/shopcart/buy_again",api_order_cancel=base+"/order/cancel",api_pay=base+"/order/pay_again",api_order_pay_check=base+"/order/pay_check",api_order_settlement=base+"/order/settlement",api_order_list=base+"/order/list",api_order_delete=base+"/order/delete",api_order_express=base+"/order/express",api_order_detail=base+"/order/detail",api_order_count=base+"/order/count",api_areas=base+"/areas",api_search_recently=base+"/search/recently",api_search_delete=base+"/search/delete",api_search_hot=base+"/search/hot",api_pvs=base+"/pvs",api_wx_user_info=base+"/oauth/user_info",api_wx_verify=base+"/oauth/js_verify",api_wx_access_token=base+"/oauth/access_token",api_wx_focus=base+"/oauth/focus",domain="m.jiankanghao.net",per_page=8,user_uuid="59qkkf4l",share_img="http://shenhuanglive.oss-cn-shanghai.aliyuncs.com/image/test_img/59eea059b5d8f.png",share_link=accesspath+"wx_index.html",share_title="神黄健康号",share_desc="神黄健康号是依托国家中医药大数据平台“中医智库”，利用中医智库国医、名医、名方等资源打造的中医养生健康管理平台。平台秉承神黄“为往圣继绝学，为万众谋健康”的理念，为大众提供中医养生知识学习、健康管理、名方古方普及等日常健康内容学习、参与和互动。",appId="wxcc7ab5ca954203d8",open_id=$.cookie("hwkx_open_id");wxOuth(),Array.prototype.unique=function(){for(var e=[],a={},t=0;t<this.length;t++)a[this[t]]||(e.push(this[t]),a[this[t]]=1);return e},Date.prototype.Format=function(e){var a={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var t in a)new RegExp("("+t+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?a[t]:("00"+a[t]).substr((""+a[t]).length)));return e},function(e,a){var t=e.documentElement,o="orientationchange"in window?"orientationchange":"resize",s=function(){var e=t.clientWidth;e&&(t.style.fontSize=e/750*100+"px")};e.addEventListener&&(a.addEventListener(o,s,!1),e.addEventListener("DOMContentLoaded",s,!1))}(document,window);var sendSms=function(){var e=$("#phone").val().trim();if(!checkParam(e,"phone","手机号"))return!1;mui(".body-bind").off("tap",".btn-verify"),changBtnHtml();httpGet(api_verify_code,{phone:e})};